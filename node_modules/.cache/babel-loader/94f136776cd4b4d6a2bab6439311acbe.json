{"remainingRequest":"/Users/liuzhengwei/SJTU/HCI/CloudWatch/node_modules/babel-loader/lib/index.js!/Users/liuzhengwei/SJTU/HCI/CloudWatch/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/liuzhengwei/SJTU/HCI/CloudWatch/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/liuzhengwei/SJTU/HCI/CloudWatch/src/components/video/video.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/liuzhengwei/SJTU/HCI/CloudWatch/src/components/video/video.vue","mtime":1593522787374},{"path":"/Users/liuzhengwei/SJTU/HCI/CloudWatch/node_modules/cache-loader/dist/cjs.js","mtime":1589115288536},{"path":"/Users/liuzhengwei/SJTU/HCI/CloudWatch/node_modules/babel-loader/lib/index.js","mtime":1589115288422},{"path":"/Users/liuzhengwei/SJTU/HCI/CloudWatch/node_modules/cache-loader/dist/cjs.js","mtime":1589115288536},{"path":"/Users/liuzhengwei/SJTU/HCI/CloudWatch/node_modules/vue-loader/lib/index.js","mtime":1589115292369}],"contextDependencies":[],"result":["import _Progress2 from \"element-ui/lib/theme-chalk/progress.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Progress from \"element-ui/lib/progress\";\nimport _Upload2 from \"element-ui/lib/theme-chalk/upload.css\";\nimport \"element-ui/lib/theme-chalk/base.css\";\nimport _Upload from \"element-ui/lib/upload\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from 'axios';\nimport TcVod from 'vod-js-sdk-v6';\nexport default {\n  name: 'TcPlayer',\n  props: {\n    isFullscreen: Boolean\n  },\n  computed: {\n    isFull: function isFull() {\n      return this.isFullscreen;\n    }\n  },\n  components: {\n    ElUpload: _Upload,\n    ElProgress: _Progress\n  },\n  data: function data() {\n    return {\n      tcPlayerId: 'tcPlayer' + Date.now(),\n      player: null,\n      showList: false,\n      showVideo: false,\n      showJindu: false,\n      isPause: false,\n      uploader: null,\n      jindu: 0,\n      Fileid: null,\n      Appid: '1301931404',\n      list: [{\n        cover: require(\"../../assets/image/video.jpg\"),\n        name: '主题曲片花',\n        fileId: '5285890804129534917',\n        text: '简介1'\n      }, {\n        cover: require(\"../../assets/image/video.jpg\"),\n        name: '一路向北',\n        fileId: '5285890804272485428',\n        text: '简介2'\n      }, {\n        cover: require(\"../../assets/image/video.jpg\"),\n        name: 'live',\n        fileId: '5285890801792789133',\n        text: '简介3'\n      }, {\n        cover: require(\"../../assets/image/video.jpg\"),\n        name: '浪姐',\n        fileId: '5285890804347869645',\n        text: '简介4'\n      }, {\n        cover: require(\"../../assets/image/video.jpg\"),\n        name: '庆佘年',\n        fileId: '5285890804447813743',\n        text: '简介5'\n      }, {\n        cover: require(\"../../assets/image/video.jpg\"),\n        name: '浪姐预告',\n        fileId: '5285890804334475959',\n        text: '简介6'\n      }]\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    var self = this;\n    this.$nextTick(function () {\n      setTimeout(function () {\n        var videoFileid = _this.Fileid;\n        var videoAppid = _this.Appid;\n        self.getVideoLang(videoFileid, videoAppid);\n        axios.get('http://47.103.30.166:8020/Room/findById', {\n          params: {\n            room_id: _this.$store.state.currentRoomId\n          }\n        }).then(function (res) {\n          if (res.data.videoFileId != undefined || res.data.videoFileId != null) {\n            _this.$store.commit('setVideoRoomId', _this.Fileid);\n\n            _this.player.loadVideoByID({\n              fileID: res.data.videoFileId,\n              // 请传入需要播放的视频 filID（必须）\n              appID: _this.Appid // 请传入点播账号的 appID（必须）\n\n            });\n\n            _this.showVideo = true;\n            _this.$parent.showVideo = true;\n          }\n        });\n      }, 400);\n    });\n  },\n  methods: {\n    // 初始化腾讯云播放器\n    getVideoLang: function getVideoLang(fileID, appID) {\n      var playerParam = {\n        fileID: this.Fileid,\n        appID: appID,\n        controlBar: {\n          fullscreenToggle: false,\n          playbackRateMenuButton: false\n        }\n      };\n      this.player = window.TCPlayer(this.tcPlayerId, playerParam);\n      this.player.on('playing', setInterval(this.playVideo, 2000));\n\n      if (this.$store.state.currentRoom.kindRoom == 1) {\n        this.player.on('play', this.beginRecord);\n        this.player.on('pause', this.finishRecord);\n      }\n    },\n    // 视频状态改变回调函数，用户录制\n    beginRecord: function beginRecord() {\n      this.$store.commit('setVideoRoomId', this.Fileid);\n      axios.get('http://47.103.30.166:8020/Room/setSDK', {\n        params: {\n          room_id: this.$store.state.currentRoomId,\n          video_id: this.$store.state.currentVideoRoomId\n        }\n      });\n      this.$parent.beginRecord();\n    },\n    finishRecord: function finishRecord() {\n      this.$parent.finishRecord();\n    },\n    playVideo: function playVideo() {\n      var self = this;\n\n      if (this.player != null) {\n        var time = this.player.currentTime(); //alert(time)\n\n        axios.get('http://47.103.30.166:8020/videoroom/play', {\n          params: {\n            roomid: this.$store.state.currentRoomId,\n            //RoomId: '666',\n            curTime: time\n          }\n        }).then(function (response) {\n          //alert(response.data)\n          //if(player.paused){\n          //  setInterval(pause,5000);\n          //}\n          if (Math.abs(response.data - time) > 0.5) {\n            self.player.currentTime(response.data + 1);\n          }\n        });\n      }\n    },\n    getSignature: function getSignature() {\n      return axios.post('http://47.103.30.166:8020/videoroom/signature').then(function (response) {\n        //alert(response.data)\n        console.log(response);\n        return response.data;\n      });\n    },\n    cancelUploader: function cancelUploader() {\n      this.uploader.cancel();\n      this.showJindu = false;\n    },\n    ShangChuan: function ShangChuan(event) {\n      var _this2 = this;\n\n      var self = this;\n\n      if (this.uploader != null) {\n        this.uploader.cancel();\n      } //let file = document.querySelector('input[type=file]')\n      //let mediaFile = file.files[0]\n\n\n      var mediaFile = event.raw;\n      var tcVod = new TcVod({\n        getSignature: this.getSignature // 前文中所述的获取上传签名的函数\n\n      });\n      this.uploader = tcVod.upload({\n        mediaFile: mediaFile // 媒体文件（视频或音频或图片），类型为 File\n\n      });\n      this.uploader.on('media_progress', function (info) {\n        self.showJindu = true;\n        window.console.log(info.percent); // 进度\n\n        self.jindu = info.percent * 100;\n      });\n      this.uploader.done().then(function (doneResult) {\n        self.showJindu = false;\n        self.Fileid = doneResult.fileId;\n        axios.get('http://47.103.30.166:8020/Room/setVideo', {\n          params: {\n            room_id: self.$store.state.currentRoomId,\n            videoFileId: self.Fileid\n          }\n        }).then(function (res) {\n          window.console.log(res);\n\n          _this2.$store.commit('setVideoRoomId', self.Fileid);\n\n          self.player.loadVideoByID({\n            fileID: self.Fileid,\n            // 请传入需要播放的视频 filID（必须）\n            appID: self.Appid // 请传入点播账号的 appID（必须）\n\n          });\n          self.showVideo = true;\n          self.$parent.showVideo = true;\n        });\n      });\n    },\n    showVideoList: function showVideoList() {\n      this.showList = !this.showList;\n    },\n    changeVideo: function changeVideo(fileID) {\n      var _this3 = this;\n\n      if (this.uploader != null) {\n        this.uploader.cancel();\n      }\n\n      this.Fileid = fileID;\n      axios.get('http://47.103.30.166:8020/Room/setVideo', {\n        params: {\n          room_id: this.$store.state.currentRoomId,\n          videoFileId: this.Fileid\n        }\n      }).then(function (res) {\n        _this3.$store.commit('setVideoRoomId', _this3.Fileid);\n\n        _this3.player.loadVideoByID({\n          fileID: _this3.Fileid,\n          // 请传入需要播放的视频 filID（必须）\n          appID: _this3.Appid // 请传入点播账号的 appID（必须）\n\n        });\n\n        _this3.showVideo = true;\n        _this3.$parent.showVideo = true;\n      });\n    }\n  }\n};",{"version":3,"sources":["video.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"container\">\n        <div id=\"detail\" :class=\"isFull? 'full':'detail'\" v-show=\"showVideo\">\n            <video\n                    :id=\"tcPlayerId\"\n                    class=\"tc-video-container\"\n                    playsinline\n                    webkit-playinline\n                    x5-playinline>\n            </video>\n        </div>\n        <div v-if=\"!showVideo\" class=\"center\">\n            <div class=\"showvideolist\">\n                <el-button type=\"primary\" round @click=\"showVideoList\">浏览视频库</el-button>\n            </div>\n            <div class=\"videolist\" style=\"margin-top: 5px\" v-show=\"showList\">\n                <ul>\n                    <li v-for=\"(item,index) in list\" :key=\"index\" style=\"display: inline-block;margin-left: 10px\">\n                        <img :src=\"item.cover\" style=\"width: 80px;height: 80px\" @click=\"changeVideo(item.fileId)\"/>\n                        <p>{{item.name}}</p>\n                        <p>视频简介：{{item.text}}</p>\n                    </li>\n                </ul>\n            </div>\n            <el-upload\n                    action=\"\"\n                    :limit=\"1\"\n                    drag\n                    :auto-upload=\"false\"\n                    list-type=\"picture\"\n                    :on-change=\"ShangChuan\"\n                    class=\"center\"\n                    :on-remove=\"cancelUploader\"\n            >\n                <div class=\"el-upload__tip\">只能上传常见视频格式文件</div>\n                <i class=\"el-icon-upload\"></i>\n                <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\n            </el-upload>\n            <!--        <div class=\"\" style=\"margin-top: 5px\">-->\n            <!--          <input id=\"uploadVideoNow-file\" type=\"file\" accept=\"video/*\"/>-->\n            <!--          <input type=\"button\" value=\"上传本地视频\" v-on:click=\"ShangChuan\"/>-->\n            <!--        </div>-->\n            <div class=\"progress\" v-show=\"showJindu\">\n                <el-progress :text-inside=\"true\" :stroke-width=\"30\" :percentage=\"parseInt(jindu)\"></el-progress>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n    import axios from 'axios'\n    import TcVod from 'vod-js-sdk-v6'\n    import {Progress, Upload} from 'element-ui'\n\n    export default {\n        name: 'TcPlayer',\n        props: {\n            isFullscreen: Boolean,\n        },\n        computed: {\n            isFull: function () {\n                return this.isFullscreen\n            }\n        },\n        components: {\n            ElUpload: Upload,\n            ElProgress: Progress\n        },\n        data() {\n            return {\n                tcPlayerId: 'tcPlayer' + Date.now(),\n                player: null,\n                showList: false,\n                showVideo: false,\n                showJindu: false,\n                isPause:false,\n                uploader: null,\n                jindu: 0,\n                Fileid: null,\n                Appid: '1301931404',\n                list: [\n                    {\n                        cover: require('../../assets/image/video.jpg'),\n                        name: '主题曲片花',\n                        fileId: '5285890804129534917',\n                        text: '简介1'\n                    },\n                    {\n                        cover: require('../../assets/image/video.jpg'),\n                        name: '一路向北',\n                        fileId: '5285890804272485428',\n                        text: '简介2'\n                    },\n                    {\n                        cover: require('../../assets/image/video.jpg'),\n                        name: 'live',\n                        fileId: '5285890801792789133',\n                        text: '简介3'\n                    },\n                    {\n                        cover: require('../../assets/image/video.jpg'),\n                        name: '浪姐',\n                        fileId: '5285890804347869645',\n                        text: '简介4'\n                    },\n                    {\n                        cover: require('../../assets/image/video.jpg'),\n                        name: '庆佘年',\n                        fileId: '5285890804447813743',\n                        text: '简介5'\n                    },\n                    {\n                        cover: require('../../assets/image/video.jpg'),\n                        name: '浪姐预告',\n                        fileId: '5285890804334475959',\n                        text: '简介6'\n                    }\n                ]\n            }\n        },\n        mounted() {\n            let self = this\n\n            this.$nextTick(() => {\n              setTimeout(() => {\n                  let videoFileid = this.Fileid\n                  let videoAppid = this.Appid\n                  self.getVideoLang(videoFileid, videoAppid)\n                  axios.get('http://47.103.30.166:8020/Room/findById', {\n                      params: {\n                          room_id: this.$store.state.currentRoomId\n                      }\n                  }).then(res => {\n                      if (res.data.videoFileId != undefined || res.data.videoFileId != null) {\n                          this.$store.commit('setVideoRoomId', this.Fileid)\n                          this.player.loadVideoByID({\n                              fileID: res.data.videoFileId, // 请传入需要播放的视频 filID（必须）\n                              appID: this.Appid, // 请传入点播账号的 appID（必须）\n                          })\n                          this.showVideo=true\n                          this.$parent.showVideo=true\n                      }\n                  })\n              }, 400)\n            })\n        },\n        methods: {\n            // 初始化腾讯云播放器\n            getVideoLang(fileID, appID) {\n                const playerParam = {\n                    fileID: this.Fileid,\n                    appID: appID,\n                    controlBar: {\n                        fullscreenToggle: false,\n                        playbackRateMenuButton: false\n                    }\n                }\n                this.player = window.TCPlayer(this.tcPlayerId, playerParam)\n                this.player.on('playing', setInterval(this.playVideo, 2000))\n\n                if (this.$store.state.currentRoom.kindRoom == 1) {\n                    this.player.on('play', this.beginRecord)\n                    this.player.on('pause', this.finishRecord)\n                }\n            },\n\n            // 视频状态改变回调函数，用户录制\n            beginRecord() {\n                this.$store.commit('setVideoRoomId', this.Fileid)\n                axios.get('http://47.103.30.166:8020/Room/setSDK', {\n                    params: {\n                        room_id: this.$store.state.currentRoomId,\n                        video_id: this.$store.state.currentVideoRoomId\n                    }\n                })\n                this.$parent.beginRecord()\n            },\n            finishRecord() {\n                this.$parent.finishRecord()\n            },\n\n            playVideo() {\n                let self = this\n                if (this.player != null) {\n                    let time = this.player.currentTime()\n                    //alert(time)\n                    axios.get('http://47.103.30.166:8020/videoroom/play', {\n                        params: {\n                            roomid: this.$store.state.currentRoomId,\n                            //RoomId: '666',\n                            curTime: time\n                        }\n                    }).then(function (response) {\n                        //alert(response.data)\n                        //if(player.paused){\n                        //  setInterval(pause,5000);\n                        //}\n                        if (Math.abs(response.data - time) > 0.5) {\n                            self.player.currentTime(response.data + 1)\n                        }\n                    })\n                }\n            },\n\n            getSignature() {\n                return axios.post('http://47.103.30.166:8020/videoroom/signature')\n                    .then(function (response) {\n                        //alert(response.data)\n                        console.log(response)\n                        return response.data\n                    })\n            },\n            cancelUploader() {\n                this.uploader.cancel()\n                this.showJindu = false\n            },\n            ShangChuan(event) {\n                let self = this\n                if (this.uploader != null) {\n                    this.uploader.cancel()\n                }\n                //let file = document.querySelector('input[type=file]')\n                //let mediaFile = file.files[0]\n                let mediaFile = event.raw\n                const tcVod = new TcVod({\n                    getSignature: this.getSignature // 前文中所述的获取上传签名的函数\n                })\n                this.uploader = tcVod.upload({\n                    mediaFile: mediaFile, // 媒体文件（视频或音频或图片），类型为 File\n                })\n                this.uploader.on('media_progress', function (info) {\n                    self.showJindu = true\n                    window.console.log(info.percent) // 进度\n                    self.jindu = info.percent * 100\n                })\n                this.uploader.done().then( doneResult => {\n                    self.showJindu = false\n                    self.Fileid = doneResult.fileId\n                    axios.get('http://47.103.30.166:8020/Room/setVideo', {\n                        params: {\n                            room_id: self.$store.state.currentRoomId,\n                            videoFileId: self.Fileid\n                        }\n                    }).then(res => {\n                        window.console.log(res)\n                        this.$store.commit('setVideoRoomId', self.Fileid)\n                        self.player.loadVideoByID({\n                            fileID: self.Fileid, // 请传入需要播放的视频 filID（必须）\n                            appID: self.Appid, // 请传入点播账号的 appID（必须）\n                        })\n                        self.showVideo = true\n                        self.$parent.showVideo = true\n                    })\n                })\n            },\n            showVideoList() {\n                this.showList = !this.showList\n            }\n            ,\n            changeVideo(fileID) {\n                if (this.uploader != null) {\n                    this.uploader.cancel()\n                }\n\n                this.Fileid = fileID\n                axios.get('http://47.103.30.166:8020/Room/setVideo', {\n                    params: {\n                        room_id: this.$store.state.currentRoomId,\n                        videoFileId: this.Fileid\n                    }\n                }).then(res => {\n                    this.$store.commit('setVideoRoomId', this.Fileid)\n                    this.player.loadVideoByID({\n                        fileID: this.Fileid, // 请传入需要播放的视频 filID（必须）\n                        appID: this.Appid, // 请传入点播账号的 appID（必须）\n                    })\n                    this.showVideo = true\n                    this.$parent.showVideo = true\n                })\n            }\n        }\n    }\n\n\n</script>\n\n<style lang='stylus' scoped>\n    .container {\n        width: 100%;\n        height: 100%;\n    }\n\n    .detail {\n        padding-left: 15%;\n        padding-right: 15%;\n        padding-top: 5%;\n        height: 70%;\n    }\n\n    .full {\n        padding: 0;\n        width: 100.5%;\n        left: -0.25%;\n        height: 95.25%;\n        top: -0.25%;\n    }\n\n    .video {\n        width: 100%;\n        height: 100%;\n        margin: 0;\n    }\n\n    .buttons {\n        height: 3%;\n    }\n\n    .tc-video-container {\n        width: 100%;\n        height: 100%;\n    }\n\n    .center {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n    }\n\n    .jindutiao {\n        width: 250px;\n        height: 20px;\n        border: black 2px solid;\n    }\n\n    .jindutiao span {\n        float: left;\n        height: 20px;\n        background: #66afe9;\n    }\n\n    .showvideolist {\n        padding: 5% 10%;\n    }\n\n    .progress {\n        padding: 10% 12% 0%;\n        width: 100%;\n        height: 100%;\n    }\n\n    @import url(\"//unpkg.com/element-ui@2.13.2/lib/theme-chalk/index.css\");\n</style>\n"],"sourceRoot":"src/components/video"}]}