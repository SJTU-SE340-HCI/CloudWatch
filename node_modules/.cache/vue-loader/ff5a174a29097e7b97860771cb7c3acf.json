{"remainingRequest":"D:\\HCI\\github\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HCI\\github\\src\\components\\group\\member-profile-card.vue?vue&type=style&index=0&id=841fcbd2&lang=stylus&scoped=true&","dependencies":[{"path":"D:\\HCI\\github\\src\\components\\group\\member-profile-card.vue","mtime":1589122703608},{"path":"D:\\HCI\\github\\node_modules\\css-loader\\index.js","mtime":1589122692960},{"path":"D:\\HCI\\github\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1589122702781},{"path":"D:\\HCI\\github\\node_modules\\postcss-loader\\src\\index.js","mtime":1589122698492},{"path":"D:\\HCI\\github\\node_modules\\stylus-loader\\index.js","mtime":1589122702034},{"path":"D:\\HCI\\github\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1589122691350},{"path":"D:\\HCI\\github\\node_modules\\vue-loader\\lib\\index.js","mtime":1589122702780}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.member-profile-card-wrapper {\r\n  max-width: 300px;\r\n  padding: 24px;\r\n  background: #fff;\r\n  border-radius: 5px;\r\n  position: fixed;\r\n  box-shadow: 0 0 10px gray;\r\n\r\n  .profile {\r\n    display: flex;\r\n\r\n    .avatar {\r\n      width: 60px;\r\n      height: 60px;\r\n      margin-right: 12px;\r\n    }\r\n\r\n    .basic {\r\n      display: flex;\r\n      align-items: flex-start;\r\n      flex-direction: column;\r\n    }\r\n  }\r\n\r\n  .divider {\r\n    margin: 12px 0;\r\n  }\r\n\r\n  .member-profile {\r\n    margin-bottom: 12px;\r\n\r\n    .item {\r\n      font-size: 15px;\r\n\r\n      .label {\r\n        display: inline-block;\r\n        width: 4em;\r\n        text-align: justify;\r\n        text-align-last: justify;\r\n        color: gray;\r\n      }\r\n    }\r\n  }\r\n  .send-message-btn {\r\n    float right\r\n  }\r\n}\r\n",{"version":3,"sources":["member-profile-card.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"member-profile-card.vue","sourceRoot":"src/components/group","sourcesContent":["<template>\r\n  <transition name=\"el-fade-in\">\r\n    <div\r\n      class=\"member-profile-card-wrapper\"\r\n      ref=\"member-profile-card\"\r\n      v-show=\"visible\"\r\n      :style=\"{top: y + 'px', left: x + 'px'}\"\r\n    >\r\n      <div class=\"profile\">\r\n        <avatar :src=\"member.avatar\" class=\"avatar\" />\r\n        <div class=\"basic\">\r\n          <span>ID：{{member.userID}}</span>\r\n          <span>昵称：{{member.nick||\"暂无\"}}</span>\r\n        </div>\r\n      </div>\r\n      <el-divider class=\"divider\" />\r\n      <div class=\"member-profile\">\r\n        <div class=\"item\">\r\n          <span class=\"label\">群名片</span>\r\n          {{member.nameCard||\"暂无\"}}\r\n        </div>\r\n        <div class=\"item\">\r\n          <span class=\"label\">入群时间</span>\r\n          {{joinTime}}\r\n        </div>\r\n        <div v-if=\"member.muteUntil\" class=\"item\">\r\n          <span class=\"label\">禁言至</span>\r\n          {{muteUntil}}\r\n        </div>\r\n      </div>\r\n      <el-button\r\n        class=\"send-message-btn\"\r\n        type=\"primary\"\r\n        size=\"mini\"\r\n        title=\"发消息\"\r\n        @click=\"handleSendMessage\"\r\n        icon=\"el-icon-message\"\r\n        circle\r\n      ></el-button>\r\n    </div>\r\n  </transition>\r\n</template>\r\n\r\n<script>\r\nimport { Divider } from 'element-ui'\r\nimport { getFullDate } from '../../utils/date'\r\n\r\n// 群成员资料卡片组件，全局共用同一个组件。\r\nexport default {\r\n  name: 'MemberProfileCard',\r\n  components: {\r\n    ElDivider: Divider\r\n  },\r\n  data() {\r\n    return {\r\n      member: {},\r\n      x: 0, // 显示的位置 x\r\n      y: 0, // 显示的位置 y\r\n      visible: false\r\n    }\r\n  },\r\n  mounted() {\r\n    // 通过事件总线，监听 showMemebrProfile 事件\r\n    this.$bus.$on('showMemberProfile', this.handleShowMemberProfile, this)\r\n  },\r\n  computed: {\r\n    joinTime() {\r\n      if (this.member.joinTime) {\r\n        return getFullDate(new Date(this.member.joinTime * 1000))\r\n      }\r\n      return ''\r\n    },\r\n    muteUntil() {\r\n      if (this.member.muteUntil) {\r\n        return getFullDate(new Date(this.member.muteUntil * 1000))\r\n      }\r\n      return ''\r\n    }\r\n  },\r\n  methods: {\r\n    handleSendMessage() {\r\n      this.$store.dispatch('checkoutConversation', `C2C${this.member.userID}`)\r\n      this.hide()\r\n    },\r\n    handleShowMemberProfile({ event, member }) {\r\n      // 可以拿到 meber 和 点击事件的 event 信息\r\n      this.member = member || {}\r\n      this.x = event.x\r\n      this.y = event.y\r\n      this.show()\r\n    },\r\n    show() {\r\n      if (this.visible) {\r\n        return\r\n      }\r\n      // 显示时，监听全局点击事件，若点击区域不是当前组件，则隐藏\r\n      window.addEventListener('click', this.handleClick, this)\r\n      this.visible = true\r\n    },\r\n    hide() {\r\n      if (!this.visible) {\r\n        return\r\n      }\r\n      // 隐藏时，注销监听\r\n      window.removeEventListener('click', this.handleClick, this)\r\n      this.visible = false\r\n    },\r\n    handleClick(event) {\r\n      // 判断点击区域是否是当前组件，若不是，则隐藏组件\r\n      if (event.target !== this.$refs['member-profile-card']) {\r\n        this.hide()\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"stylus\" scoped>\r\n.member-profile-card-wrapper {\r\n  max-width: 300px;\r\n  padding: 24px;\r\n  background: #fff;\r\n  border-radius: 5px;\r\n  position: fixed;\r\n  box-shadow: 0 0 10px gray;\r\n\r\n  .profile {\r\n    display: flex;\r\n\r\n    .avatar {\r\n      width: 60px;\r\n      height: 60px;\r\n      margin-right: 12px;\r\n    }\r\n\r\n    .basic {\r\n      display: flex;\r\n      align-items: flex-start;\r\n      flex-direction: column;\r\n    }\r\n  }\r\n\r\n  .divider {\r\n    margin: 12px 0;\r\n  }\r\n\r\n  .member-profile {\r\n    margin-bottom: 12px;\r\n\r\n    .item {\r\n      font-size: 15px;\r\n\r\n      .label {\r\n        display: inline-block;\r\n        width: 4em;\r\n        text-align: justify;\r\n        text-align-last: justify;\r\n        color: gray;\r\n      }\r\n    }\r\n  }\r\n  .send-message-btn {\r\n    float right\r\n  }\r\n}\r\n</style>"]}]}