{"remainingRequest":"/run/media/gz/G/c2020spring/hci/project/FrontEnd/node_modules/vue-loader/lib/index.js??vue-loader-options!/run/media/gz/G/c2020spring/hci/project/FrontEnd/src/components/group/create-group.vue?vue&type=script&lang=js&","dependencies":[{"path":"/run/media/gz/G/c2020spring/hci/project/FrontEnd/src/components/group/create-group.vue","mtime":1588990158993},{"path":"/run/media/gz/G/c2020spring/hci/project/FrontEnd/node_modules/babel-loader/lib/index.js","mtime":1588990144242},{"path":"/run/media/gz/G/c2020spring/hci/project/FrontEnd/node_modules/cache-loader/dist/cjs.js","mtime":1588990144497},{"path":"/run/media/gz/G/c2020spring/hci/project/FrontEnd/node_modules/vue-loader/lib/index.js","mtime":1588990158440}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n  Form,\n  FormItem,\n  Input,\n  Select,\n  Option,\n  Radio,\n  RadioGroup\n} from 'element-ui'\nexport default {\n  components: {\n    ElForm: Form,\n    ElFormItem: FormItem,\n    ElInput: Input,\n    ElSelect: Select,\n    ElOption: Option,\n    ElRadioGroup: RadioGroup,\n    ElRadio: Radio\n  },\n  data() {\n    return {\n      form: {\n        groupID: '',\n        name: '',\n        type: 'Private',\n        avatar: '',\n        introduction: '',\n        notification: '',\n        joinOption: 'FreeAccess',\n        memberList: []\n      },\n      options: [],\n      loading: false,\n      rules: {\n        name: [{ required: true, message: '请输入群名称', trigger: 'blur' }]\n      }\n    }\n  },\n  computed: {\n    joinOptionDisabled() {\n      return [\n        this.TIM.TYPES.GRP_PRIVATE,\n        this.TIM.TYPES.GRP_CHATROOM,\n        this.TIM.TYPES.GRP_AVCHATROOM\n      ].includes(this.form.type)\n    }\n  },\n  methods: {\n    onSubmit(ref) {\n      this.$refs[ref].validate(valid => {\n        if (!valid) {\n          return false\n        }\n        this.createGroup()\n      })\n    },\n    closeCreateGroupModel() {\n      this.$store.commit('updateCreateGroupModelVisible', false)\n    },\n    createGroup() {\n      this.tim.createGroup(this.getOptions()).then((imResponse) => {\n         this.$store.commit('showMessage', {\n            message: `群组：【${imResponse.data.group.name}】创建成功`,\n            type: 'success'\n          })\n        this.closeCreateGroupModel()\n      })\n      .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n    },\n    getOptions() {\n      let options = {\n        ...this.form,\n        memberList: this.form.memberList.map(userID => ({ userID }))\n      }\n      if (['Private', 'AVChatRoom'].includes(this.form.type)) {\n        delete options.joinOption\n      }\n      return options\n    },\n    handleSearchUser(userID) {\n      if (userID !== '') {\n        this.loading = true\n        this.tim.getUserProfile({ userIDList: [userID] }).then(({ data }) => {\n          this.options = data.map(item => item.userID)\n          this.loading = false\n        })\n        .catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n      }\n    }\n  }\n}\n",null]}