{"remainingRequest":"D:\\HCI\\github\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\HCI\\github\\src\\components\\video\\video.vue?vue&type=style&index=0&id=2924a087&lang=stylus&scoped=true&","dependencies":[{"path":"D:\\HCI\\github\\src\\components\\video\\video.vue","mtime":1593516367847},{"path":"D:\\HCI\\github\\node_modules\\css-loader\\index.js","mtime":1589122692960},{"path":"D:\\HCI\\github\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1589122702781},{"path":"D:\\HCI\\github\\node_modules\\postcss-loader\\src\\index.js","mtime":1589122698492},{"path":"D:\\HCI\\github\\node_modules\\stylus-loader\\index.js","mtime":1589122702034},{"path":"D:\\HCI\\github\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1589122691350},{"path":"D:\\HCI\\github\\node_modules\\vue-loader\\lib\\index.js","mtime":1589122702780}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.container {\n    width: 100%;\n    height: 100%;\n}\n\n.detail {\n    padding-left: 15%;\n    padding-right: 15%;\n    padding-top: 5%;\n    height: 70%;\n}\n\n.full {\n    padding: 0;\n    width: 100.5%;\n    left: -0.25%;\n    height: 95.25%;\n    top: -0.25%;\n}\n\n.video {\n    width: 100%;\n    height: 100%;\n    margin: 0;\n}\n\n.buttons {\n    height: 3%;\n}\n\n.tc-video-container {\n    width: 100%;\n    height: 100%;\n}\n\n.center {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n}\n\n.jindutiao {\n    width: 250px;\n    height: 20px;\n    border: black 2px solid;\n}\n\n.jindutiao span {\n    float: left;\n    height: 20px;\n    background: #66afe9;\n}\n\n.showvideolist {\n    padding: 5% 10%;\n}\n\n.progress {\n    padding: 10% 12% 0%;\n    width: 100%;\n    height: 100%;\n}\n\n@import url(\"//unpkg.com/element-ui@2.13.2/lib/theme-chalk/index.css\");\n",{"version":3,"sources":["video.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwYA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA","file":"video.vue","sourceRoot":"src/components/video","sourcesContent":["<template>\r\n    <div class=\"container\">\r\n        <div id=\"detail\" :class=\"isFull? 'full':'detail'\" v-show=\"showVideo\">\r\n            <video\r\n                    :id=\"tcPlayerId\"\r\n                    class=\"tc-video-container\"\r\n                    playsinline\r\n                    webkit-playinline\r\n                    x5-playinline>\r\n            </video>\r\n        </div>\r\n        <div v-if=\"!showVideo\" class=\"center\">\r\n            <div class=\"showvideolist\">\r\n                <el-button type=\"primary\" round @click=\"showVideoList\">浏览视频库</el-button>\r\n            </div>\r\n            <div class=\"videolist\" style=\"margin-top: 5px\" v-show=\"showList\">\r\n                <ul>\r\n                    <li v-for=\"(item,index) in list\" :key=\"index\" style=\"display: inline-block;margin-left: 10px\">\r\n                        <img :src=\"item.cover\" style=\"width: 80px;height: 80px\" @click=\"changeVideo(item.fileId)\"/>\r\n                        <p>{{item.name}}</p>\r\n                        <p>视频简介：{{item.text}}</p>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n            <el-upload\r\n                    action=\"\"\r\n                    :limit=\"1\"\r\n                    drag\r\n                    :auto-upload=\"false\"\r\n                    list-type=\"picture\"\r\n                    :on-change=\"ShangChuan\"\r\n                    class=\"center\"\r\n                    :on-remove=\"cancelUploader\"\r\n            >\r\n                <div class=\"el-upload__tip\">只能上传常见视频格式文件</div>\r\n                <i class=\"el-icon-upload\"></i>\r\n                <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n            </el-upload>\r\n            <!--        <div class=\"\" style=\"margin-top: 5px\">-->\r\n            <!--          <input id=\"uploadVideoNow-file\" type=\"file\" accept=\"video/*\"/>-->\r\n            <!--          <input type=\"button\" value=\"上传本地视频\" v-on:click=\"ShangChuan\"/>-->\r\n            <!--        </div>-->\r\n            <div class=\"progress\" v-show=\"showJindu\">\r\n                <el-progress :text-inside=\"true\" :stroke-width=\"30\" :percentage=\"parseInt(jindu)\"></el-progress>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import axios from 'axios'\r\n    import TcVod from 'vod-js-sdk-v6'\r\n    import {Progress, Upload} from 'element-ui'\r\n\r\n<<<<<<< HEAD\r\n    export default {\r\n        name: 'TcPlayer',\r\n        props: {\r\n            isFullscreen: Boolean,\r\n        },\r\n        computed: {\r\n            isFull: function () {\r\n                return this.isFullscreen\r\n            }\r\n        },\r\n        components: {\r\n            ElUpload: Upload,\r\n            ElProgress: Progress\r\n        },\r\n        data() {\r\n            return {\r\n                tcPlayerId: 'tcPlayer' + Date.now(),\r\n                player: null,\r\n                showList: false,\r\n                showVideo: false,\r\n                showJindu: false,\r\n                isPause:false,\r\n                uploader: null,\r\n                jindu: 0,\r\n                Fileid: '0',\r\n                Appid: '1301931404',\r\n                list: [\r\n                    {\r\n                        cover: require('../../assets/image/video.jpg'),\r\n                        name: '主题曲片花',\r\n                        fileId: '5285890804129534917',\r\n                        text: '简介1'\r\n                    },\r\n                    {\r\n                        cover: require('../../assets/image/video.jpg'),\r\n                        name: '一路向北',\r\n                        fileId: '5285890804272485428',\r\n                        text: '简介2'\r\n                    },\r\n                    {\r\n                        cover: require('../../assets/image/video.jpg'),\r\n                        name: 'live',\r\n                        fileId: '5285890801792789133',\r\n                        text: '简介3'\r\n                    },\r\n                    {\r\n                        cover: require('../../assets/image/video.jpg'),\r\n                        name: '浪姐',\r\n                        fileId: '5285890804347869645',\r\n                        text: '简介4'\r\n                    },\r\n                    {\r\n                        cover: require('../../assets/image/video.jpg'),\r\n                        name: '庆佘年',\r\n                        fileId: '5285890804447813743',\r\n                        text: '简介5'\r\n                    },\r\n                    {\r\n                        cover: require('../../assets/image/video.jpg'),\r\n                        name: '浪姐预告',\r\n                        fileId: '5285890804334475959',\r\n                        text: '简介6'\r\n                    }\r\n                ]\r\n            }\r\n        },\r\n        mounted() {\r\n            let self = this\r\n            let videoFileid = this.Fileid\r\n            let videoAppid = this.Appid\r\n            self.getVideoLang(videoFileid, videoAppid)\r\n            axios.get('http://47.103.30.166:8020/Room/findById', {\r\n                params: {\r\n                    room_id: this.$store.state.currentRoomId\r\n                }\r\n            }).then(res => {\r\n                if (res.data.videoFileId != undefined || res.data.videoFileId != null) {\r\n                    // this.$store.commit('setVideoRoomId', this.Fileid)\r\n                    // this.player.loadVideoByID({\r\n                    //   fileID: res.data.videoFileId, // 请传入需要播放的视频 filID（必须）\r\n                    //   appID: this.Appid, // 请传入点播账号的 appID（必须）\r\n                    // })\r\n                    // this.showVideo=true\r\n                    // this.$parent.showVideo=true\r\n                }\r\n            })\r\n            // this.$nextTick(() => {\r\n            //   setTimeout(() => {\r\n            //\r\n            //   }, 400)\r\n            // })\r\n        },\r\n        methods: {\r\n            // 初始化腾讯云播放器\r\n            getVideoLang(fileID, appID) {\r\n                const playerParam = {\r\n                    fileID: this.Fileid,\r\n                    appID: appID,\r\n                    controlBar: {\r\n                        fullscreenToggle: false,\r\n                        playbackRateMenuButton: false\r\n                    }\r\n                }\r\n                this.player = window.TCPlayer(this.tcPlayerId, playerParam)\r\n                this.player.on('playing', setInterval(this.playVideo, 2000))\r\n=======\r\n  export default {\r\n    name: 'TcPlayer',\r\n    props: {\r\n      isFullscreen: Boolean,\r\n    },\r\n    computed: {\r\n      isFull: function () {\r\n        return this.isFullscreen\r\n      }\r\n    },\r\n    components: {\r\n      ElUpload: Upload,\r\n      ElProgress: Progress\r\n    },\r\n    data() {\r\n      return {\r\n        tcPlayerId: 'tcPlayer' + Date.now(),\r\n        player: null,\r\n        RoomId: 'x2RYna',\r\n        showList:false,\r\n        showVideo:false,\r\n        showJindu:false,\r\n        uploader: null,\r\n        jindu:0,\r\n        Fileid: '5285890804272485428',\r\n        Appid: '1301931404',\r\n        list: [\r\n          {\r\n            cover:require('../../assets/image/video.jpg'),\r\n            name:'主题曲片花',\r\n            fileId:'5285890804129534917',\r\n            text:'简介1'\r\n          },\r\n          {\r\n            cover:require('../../assets/image/video.jpg'),\r\n            name:'一路向北',\r\n            fileId:'5285890804272485428',\r\n            text:'简介2'\r\n          },\r\n          {\r\n            cover:require('../../assets/image/video.jpg'),\r\n            name:'live',\r\n            fileId:'5285890801792789133',\r\n            text:'简介3'\r\n          },\r\n          {\r\n            cover:require('../../assets/image/video.jpg'),\r\n            name:'浪姐',\r\n            fileId:'5285890804347869645',\r\n            text:'简介4'\r\n          },\r\n          {\r\n            cover:require('../../assets/image/video.jpg'),\r\n            name:'庆佘年',\r\n            fileId:'5285890804447813743',\r\n            text:'简介5'\r\n          },\r\n          {\r\n            cover:require('../../assets/image/video.jpg'),\r\n            name:'浪姐预告',\r\n            fileId:'5285890804334475959',\r\n            text:'简介6'\r\n          }\r\n        ]\r\n      }\r\n    },\r\n    mounted() {\r\n      let self = this\r\n      this.$nextTick(() => {\r\n        setTimeout(() => {\r\n          let videoFileid = this.Fileid\r\n          let videoAppid = this.Appid\r\n          self.getVideoLang(videoFileid, videoAppid)\r\n          axios.get('http://47.103.30.166:8020/Room/findById', {\r\n            params: {\r\n              room_id: this.$store.state.currentRoomId\r\n            }\r\n          }).then(res => {\r\n            if (res.data != '' && (res.data.videoFileId != undefined || res.data.videoFileId != null)) {\r\n              this.$store.commit('setVideoRoomId', this.Fileid)\r\n              this.player.loadVideoByID({\r\n                fileID: res.data.videoFileId, // 请传入需要播放的视频 filID（必须）\r\n                appID: this.Appid, // 请传入点播账号的 appID（必须）\r\n              })\r\n              this.showVideo=true\r\n              this.$parent.showVideo=true\r\n            }\r\n          })\r\n        }, 400)\r\n      })\r\n    },\r\n    methods: {\r\n      // 初始化腾讯云播放器\r\n      getVideoLang(fileID, appID) {\r\n        const playerParam = {\r\n          fileID: fileID,\r\n          appID: appID\r\n        }\r\n        this.player = window.TCPlayer(this.tcPlayerId, playerParam)\r\n        if (this.$store.state.currentRoom.kindRoom==1) {\r\n          this.player.on('play',this.beginRecord)\r\n          this.player.on('pause', this.finishRecord)\r\n        }\r\n      },\r\n>>>>>>> 5b5481c3e7a9eee3a62f54396543a3c7412ecc90\r\n\r\n                if (this.$store.state.currentRoom.kindRoom == 1) {\r\n                    this.player.on('play', this.beginRecord)\r\n                    this.player.on('pause', this.finishRecord)\r\n                }\r\n            },\r\n\r\n            // 视频状态改变回调函数，用户录制\r\n            beginRecord() {\r\n                this.$store.commit('setVideoRoomId', this.Fileid)\r\n                axios.get('http://47.103.30.166:8020/Room/setSDK', {\r\n                    params: {\r\n                        room_id: this.$store.state.currentRoomId,\r\n                        video_id: this.$store.state.currentVideoRoomId\r\n                    }\r\n                })\r\n                this.$parent.beginRecord()\r\n            },\r\n            finishRecord() {\r\n                this.$parent.finishRecord()\r\n            },\r\n\r\n            playVideo() {\r\n                let self = this\r\n                let time = this.player.currentTime()\r\n                //alert(time)\r\n                axios.get('http://47.103.30.166:8020/videoroom/play', {\r\n                    params: {\r\n                        roomid: this.$store.state.currentRoomId,\r\n                        //RoomId: '666',\r\n                        curTime: time\r\n                    }\r\n                }).then(function (response) {\r\n                    //alert(response.data)\r\n                    //if(player.paused){\r\n                    //  setInterval(pause,5000);\r\n                    //}\r\n                    if (Math.abs(response.data - time) > 0.5) {\r\n                        self.player.currentTime(response.data + 1)\r\n                    }\r\n                })\r\n            },\r\n\r\n            getSignature() {\r\n                return axios.post('http://47.103.30.166:8020/videoroom/signature')\r\n                    .then(function (response) {\r\n                        //alert(response.data)\r\n                        console.log(response)\r\n                        return response.data\r\n                    })\r\n            },\r\n            cancelUploader() {\r\n                this.uploader.cancel()\r\n                this.showJindu = false\r\n            },\r\n            ShangChuan(event) {\r\n                let self = this\r\n                if (this.uploader != null) {\r\n                    this.uploader.cancel()\r\n                }\r\n                //let file = document.querySelector('input[type=file]')\r\n                //let mediaFile = file.files[0]\r\n                let mediaFile = event.raw\r\n                const tcVod = new TcVod({\r\n                    getSignature: this.getSignature // 前文中所述的获取上传签名的函数\r\n                })\r\n                this.uploader = tcVod.upload({\r\n                    mediaFile: mediaFile, // 媒体文件（视频或音频或图片），类型为 File\r\n                })\r\n                this.uploader.on('media_progress', function (info) {\r\n                    self.showJindu = true\r\n                    window.console.log(info.percent) // 进度\r\n                    self.jindu = info.percent * 100\r\n                })\r\n                this.uploader.done().then(function (doneResult) {\r\n                    self.showJindu = false\r\n                    self.Fileid = doneResult.fileId\r\n                    axios.get('http://47.103.30.166:8020/Room/setVideo', {\r\n                        params: {\r\n                            room_id: this.$store.state.currentRoomId,\r\n                            videoFileId: self.Fileid\r\n                        }\r\n                    }).then(res => {\r\n                        window.console.log(res)\r\n                        this.$store.commit('setVideoRoomId', self.Fileid)\r\n                        self.player.loadVideoByID({\r\n                            fileID: self.Fileid, // 请传入需要播放的视频 filID（必须）\r\n                            appID: self.Appid, // 请传入点播账号的 appID（必须）\r\n                        })\r\n                        self.showVideo = true\r\n                        self.$parent.showVideo = true\r\n                    })\r\n                })\r\n            },\r\n            showVideoList() {\r\n                this.showList = !this.showList\r\n            }\r\n            ,\r\n            changeVideo(fileID) {\r\n                if (this.uploader != null) {\r\n                    this.uploader.cancel()\r\n                }\r\n\r\n                this.Fileid = fileID\r\n                axios.get('http://47.103.30.166:8020/Room/setVideo', {\r\n                    params: {\r\n                        room_id: this.$store.state.currentRoomId,\r\n                        videoFileId: this.Fileid\r\n                    }\r\n                }).then(res => {\r\n                    this.$store.commit('setVideoRoomId', this.Fileid)\r\n                    this.player.loadVideoByID({\r\n                        fileID: this.Fileid, // 请传入需要播放的视频 filID（必须）\r\n                        appID: this.Appid, // 请传入点播账号的 appID（必须）\r\n                    })\r\n                    this.showVideo = true\r\n                    this.$parent.showVideo = true\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n</script>\r\n\r\n<style lang='stylus' scoped>\r\n    .container {\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n\r\n    .detail {\r\n        padding-left: 15%;\r\n        padding-right: 15%;\r\n        padding-top: 5%;\r\n        height: 70%;\r\n    }\r\n\r\n    .full {\r\n        padding: 0;\r\n        width: 100.5%;\r\n        left: -0.25%;\r\n        height: 95.25%;\r\n        top: -0.25%;\r\n    }\r\n\r\n    .video {\r\n        width: 100%;\r\n        height: 100%;\r\n        margin: 0;\r\n    }\r\n\r\n    .buttons {\r\n        height: 3%;\r\n    }\r\n\r\n    .tc-video-container {\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n\r\n    .center {\r\n        display: flex;\r\n        flex-direction: column;\r\n        align-items: center;\r\n    }\r\n\r\n    .jindutiao {\r\n        width: 250px;\r\n        height: 20px;\r\n        border: black 2px solid;\r\n    }\r\n\r\n    .jindutiao span {\r\n        float: left;\r\n        height: 20px;\r\n        background: #66afe9;\r\n    }\r\n\r\n    .showvideolist {\r\n        padding: 5% 10%;\r\n    }\r\n\r\n    .progress {\r\n        padding: 10% 12% 0%;\r\n        width: 100%;\r\n        height: 100%;\r\n    }\r\n\r\n    @import url(\"//unpkg.com/element-ui@2.13.2/lib/theme-chalk/index.css\");\r\n</style>\r\n"]}]}